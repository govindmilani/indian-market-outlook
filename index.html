!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India 2026: Strategic Market Outlook</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        .active-tab {
            background-color: #0f766e; /* teal-700 */
            color: white;
            border-bottom: 4px solid #134e4a; /* teal-900 */
        }
        .inactive-tab {
            background-color: #e7e5e4; /* stone-200 */
            color: #44403c; /* stone-700 */
            border-bottom: 4px solid transparent;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Custom scrollbar for data tables if needed */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f5f5f4;
        }
        ::-webkit-scrollbar-thumb {
            background: #a8a29e;
            border-radius: 4px;
        }
        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-start infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone/Amber) with Teal/Indigo Accents for professional financial tone. -->
    <!-- Application Structure Plan: 
         1. Hero/Executive Summary: Immediate context setting.
         2. Macro Dashboard: Quantitative "Goldilocks" data visualization.
         3. Fundamental Analysis: Interactive comparison of earnings and valuations.
         4. Strategic Themes: Tabbed interface to explore the 3 pillars (ISM 2.0, Biopharma, Infra) without clutter.
         5. Portfolio Simulator: Functional tool to apply the report's advice to user's capital.
         6. Risk/Footer: Essential caveats.
    -->
    <!-- Gemini Features Added:
         1. AI Risk Simulator: Allows users to test custom economic scenarios.
         2. Smart Investment Memo: Generates personalized strategy explanations for the user's portfolio.
    -->
</head>
<body class="bg-stone-50 text-stone-800">

    <!-- Navigation / Header -->
    <nav class="bg-stone-900 text-white sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold tracking-tight text-teal-400">STRATEGY 2026</span>
                    <span class="ml-4 text-sm text-stone-400 hidden sm:block">Indian Equity Market Outlook</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <button onclick="scrollToSection('macro')" class="hover:bg-stone-700 px-3 py-2 rounded-md text-sm font-medium transition">Macro</button>
                        <button onclick="scrollToSection('fundamentals')" class="hover:bg-stone-700 px-3 py-2 rounded-md text-sm font-medium transition">Fundamentals</button>
                        <button onclick="scrollToSection('themes')" class="hover:bg-stone-700 px-3 py-2 rounded-md text-sm font-medium transition">Themes</button>
                        <button onclick="scrollToSection('portfolio')" class="bg-teal-700 hover:bg-teal-600 px-3 py-2 rounded-md text-sm font-medium transition shadow">Portfolio Sim</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="bg-white border-b border-stone-200">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl font-extrabold text-stone-900 sm:text-5xl sm:tracking-tight lg:text-6xl">
                The Capex Pivot
            </h1>
            <p class="mt-4 max-w-2xl mx-auto text-xl text-stone-500">
                Transitioning from liquidity-fueled recovery to structural, earnings-driven growth.
            </p>
            <div class="mt-8 flex justify-center space-x-4 text-sm font-semibold">
                <span class="inline-flex items-center px-3 py-1 rounded-full bg-teal-100 text-teal-800">
                    üöÄ GDP FY26: 7.4%
                </span>
                <span class="inline-flex items-center px-3 py-1 rounded-full bg-indigo-100 text-indigo-800">
                    üìâ Fiscal Deficit: 4.3%
                </span>
                <span class="inline-flex items-center px-3 py-1 rounded-full bg-amber-100 text-amber-800">
                    üèóÔ∏è Capex: ‚Çπ12.2 Lakh Cr
                </span>
            </div>
        </div>
    </div>

    <!-- Section 1: The Macro Lens -->
    <section id="macro" class="py-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-10">
            <h2 class="text-3xl font-bold text-stone-900">The Macroeconomic Lens</h2>
            <p class="mt-4 text-lg text-stone-600 max-w-3xl mx-auto">
                India is in a "Goldilocks" scenario‚Äîrobust growth coexisting with controlled inflation. 
                The economy has effectively decoupled from developed market stagnation, driven by an investment-led shift (GFCF) rather than just consumption.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
            <!-- Macro Chart -->
            <div class="bg-white p-6 rounded-xl shadow-md card-hover border border-stone-100">
                <h3 class="text-lg font-semibold text-stone-800 mb-4">Growth vs. Fiscal Consolidation</h3>
                <div class="chart-container">
                    <canvas id="macroChart"></canvas>
                </div>
                <p class="text-xs text-stone-500 mt-2 text-center">Source: Economic Survey 2025-26 & Union Budget</p>
            </div>

            <!-- Key Indicators & Policy -->
            <div class="space-y-6">
                <div class="bg-stone-100 p-6 rounded-xl border-l-4 border-teal-500">
                    <h3 class="font-bold text-teal-700 flex items-center">
                        <span class="text-2xl mr-2">üèõÔ∏è</span> Fiscal Policy
                    </h3>
                    <p class="mt-2 text-stone-700">
                        <strong>The "Quality" Shift:</strong> The government is reducing the deficit (Target 4.3% FY27) while increasing Capex. This improves the "Fiscal Multiplier"‚Äîborrowing is used for assets (Roads, Defense), not subsidies.
                    </p>
                    <div class="mt-3 text-sm font-mono text-stone-600">
                        Debt-to-GDP Target: <span class="font-bold text-stone-900">55.6%</span>
                    </div>
                </div>

                <!-- AI Risk Simulator -->
                <div class="bg-red-50 p-6 rounded-xl border border-red-100 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-2 opacity-10 group-hover:opacity-20 transition">
                         <svg class="w-16 h-16 text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg>
                    </div>
                    <div class="relative z-10">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-red-800 flex items-center gap-2">
                                <span>‚ö°</span> AI Risk Simulator
                            </h3>
                            <span class="text-xs font-semibold text-red-600 bg-red-100 px-2 py-1 rounded uppercase tracking-wide">Gemini Powered</span>
                        </div>
                        <p class="text-sm text-red-700 mb-3">
                            Simulate economic shocks on the Indian Market context of 2026.
                        </p>
                        <div class="flex gap-2">
                            <input type="text" id="riskInput" placeholder="E.g. US Fed hikes rates to 6%..." class="flex-1 text-sm p-2 rounded border border-red-200 focus:outline-none focus:ring-2 focus:ring-red-500">
                            <button onclick="simulateRisk()" id="riskBtn" class="bg-red-600 hover:bg-red-700 text-white text-sm px-4 py-2 rounded transition font-medium whitespace-nowrap">
                                Simulate ‚ú®
                            </button>
                        </div>
                        <div id="riskResult" class="mt-3 text-sm text-red-800 bg-white/50 p-3 rounded hidden border border-red-100">
                            <!-- AI Output Here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 2: Fundamentals -->
    <section id="fundamentals" class="bg-stone-200 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-stone-900">Fundamental Health</h2>
                <p class="mt-4 text-lg text-stone-600 max-w-3xl mx-auto">
                    Corporate India is in its healthiest shape in a decade. However, recovery is "K-Shaped"‚ÄîBanks and Manufacturing are surging, while IT Services face a "winter."
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Market Cap Gauge -->
                <div class="bg-white p-6 rounded-xl shadow-md text-center">
                    <h3 class="text-lg font-semibold text-stone-700 mb-2">Market Cap to GDP</h3>
                    <div class="relative w-40 h-40 mx-auto rounded-full border-8 border-stone-100 flex items-center justify-center">
                        <div class="absolute inset-0 rounded-full border-8 border-amber-500 border-t-transparent border-l-transparent transform -rotate-45"></div>
                        <div class="text-center">
                            <span class="block text-3xl font-bold text-stone-800">111.6%</span>
                            <span class="text-xs text-stone-500">Buffett Indicator</span>
                        </div>
                    </div>
                    <p class="mt-4 text-sm text-stone-600">
                        <strong>Status: Elevated.</strong><br>
                        Justified by rising corporate profits and formalization, but warrants caution.
                    </p>
                </div>

                <!-- Small Cap Opportunity -->
                <div class="bg-white p-6 rounded-xl shadow-md col-span-1 md:col-span-2">
                    <h3 class="text-lg font-semibold text-stone-700 mb-4">The Valuation Dichotomy</h3>
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="flex-1">
                            <div class="chart-container" style="height: 250px;">
                                <canvas id="valuationChart"></canvas>
                            </div>
                        </div>
                        <div class="flex-1 flex flex-col justify-center space-y-4">
                            <div class="p-4 bg-green-50 rounded-lg border border-green-100">
                                <h4 class="font-bold text-green-800">Small Cap Opportunity</h4>
                                <p class="text-sm text-green-700 mt-1">
                                    Nifty Smallcap 250 PE is at <strong>~26.2x</strong> (near 3-year lows). With earnings growth of 15-20%, the PEG ratio is attractive (1.3-1.5).
                                </p>
                            </div>
                            <div class="p-4 bg-orange-50 rounded-lg border border-orange-100">
                                <h4 class="font-bold text-orange-800">IT Services Caution</h4>
                                <p class="text-sm text-orange-700 mt-1">
                                    Facing wage pressures and delayed discretionary spend in US/EU. "AI Revenue" is yet to materialize in EPS.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Section 3: Strategic Themes -->
    <section id="themes" class="py-12 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-stone-900">High-Conviction Themes (2026-2029)</h2>
            <p class="mt-4 text-stone-600">
                To generate alpha, look beyond broad indices to structural themes benefitting from policy tailwinds (PLI, ISM, Budget).
            </p>
        </div>

        <!-- Tabs -->
        <div class="flex flex-wrap justify-center mb-8 border-b border-stone-200">
            <button onclick="switchTheme('electronics')" id="tab-electronics" class="active-tab px-6 py-3 font-semibold text-lg focus:outline-none transition w-full sm:w-auto">
                Electronics (ISM 2.0)
            </button>
            <button onclick="switchTheme('biopharma')" id="tab-biopharma" class="inactive-tab px-6 py-3 font-semibold text-lg focus:outline-none transition w-full sm:w-auto">
                Biopharma SHAKTI
            </button>
            <button onclick="switchTheme('infra')" id="tab-infra" class="inactive-tab px-6 py-3 font-semibold text-lg focus:outline-none transition w-full sm:w-auto">
                Infra Supercycle
            </button>
        </div>

        <!-- Content Area -->
        <div id="theme-content" class="bg-white p-8 rounded-2xl shadow-lg border border-stone-100 min-h-[300px]">
            <!-- Content injected by JS -->
        </div>
    </section>

    <!-- Section 4: Portfolio Strategy -->
    <section id="portfolio" class="bg-stone-900 text-stone-100 py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                
                <!-- Calculator Controls -->
                <div>
                    <h2 class="text-3xl font-bold text-teal-400 mb-4">Strategic Portfolio Builder</h2>
                    <p class="text-stone-400 mb-8">
                        The era of "rising tides lifting all boats" is over. The 2026 strategy requires a <strong>Core-Satellite</strong> approach: Stability from Flexi-caps and Alpha from Thematic Small-caps.
                    </p>
                    
                    <div class="bg-stone-800 p-6 rounded-xl border border-stone-700">
                        <label class="block text-sm font-medium text-stone-300 mb-2">Monthly Investment Amount (SIP)</label>
                        <div class="flex items-center space-x-4 mb-4">
                            <span class="text-2xl text-stone-400">‚Çπ</span>
                            <input type="number" id="sipAmount" value="50000" class="bg-stone-700 text-white text-xl px-4 py-2 rounded-lg w-full focus:ring-2 focus:ring-teal-500 focus:outline-none" oninput="calculatePortfolio()">
                        </div>
                        
                        <!-- AI Memo Feature -->
                        <div class="bg-stone-900/50 p-4 rounded-lg border border-teal-900/50">
                            <button onclick="generateMemo()" id="memoBtn" class="w-full bg-teal-700 hover:bg-teal-600 text-white font-medium py-2 px-4 rounded transition flex items-center justify-center gap-2">
                                <span>‚ú®</span> Generate Investment Memo
                            </button>
                            <div id="memoResult" class="mt-3 text-sm text-teal-100 italic hidden border-l-2 border-teal-500 pl-3">
                                <!-- AI Output Here -->
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 space-y-4">
                        <h4 class="font-semibold text-stone-300">Allocation Strategy:</h4>
                        <div class="flex items-center">
                            <div class="w-4 h-4 rounded bg-teal-500 mr-3"></div>
                            <span class="text-stone-300 w-32">Core Equity</span>
                            <span class="text-white font-mono">50% (Stability)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 rounded bg-amber-500 mr-3"></div>
                            <span class="text-stone-300 w-32">Satellite Equity</span>
                            <span class="text-white font-mono">30% (Alpha)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 rounded bg-indigo-500 mr-3"></div>
                            <span class="text-stone-300 w-32">Thematic</span>
                            <span class="text-white font-mono">10% (Cyclical)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-4 h-4 rounded bg-rose-500 mr-3"></div>
                            <span class="text-stone-300 w-32">Dynamic</span>
                            <span class="text-white font-mono">10% (Safety)</span>
                        </div>
                    </div>
                </div>

                <!-- Dynamic Output -->
                <div class="bg-stone-800 rounded-xl p-6 shadow-xl relative">
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="portfolioChart"></canvas>
                    </div>
                    
                    <!-- Breakdown Table -->
                    <div class="mt-6 overflow-hidden rounded-lg border border-stone-700">
                        <table class="min-w-full divide-y divide-stone-700">
                            <thead class="bg-stone-900">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-stone-400 uppercase tracking-wider">Fund Category</th>
                                    <th class="px-4 py-3 text-right text-xs font-medium text-stone-400 uppercase tracking-wider">Amount</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-stone-400 uppercase tracking-wider hidden sm:table-cell">Rationale</th>
                                </tr>
                            </thead>
                            <tbody id="allocationTableBody" class="bg-stone-800 divide-y divide-stone-700 text-sm">
                                <!-- JS Populated -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer / Risks -->
    <footer class="bg-stone-950 text-stone-500 py-10 border-t border-stone-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h4 class="text-stone-300 font-bold mb-4">Critical Risks</h4>
                <ul class="space-y-2 text-sm">
                    <li>‚ö†Ô∏è <strong>Oil Shock:</strong> Prices >$90/bbl due to Middle East tension.</li>
                    <li>üå¶Ô∏è <strong>Monsoon:</strong> Sub-par rains impacting rural demand.</li>
                    <li>üèõÔ∏è <strong>Policy Gridlock:</strong> Stalling of Capex pipeline.</li>
                </ul>
            </div>
            <div>
                <h4 class="text-stone-300 font-bold mb-4">Final Verdict</h4>
                <p class="text-sm">
                    <strong>Overweight Equities</strong> with a 4-year view. Focus on Domestic Cyclicals (Banks, Infra) over Global Cyclicals. Use SIPs to navigate volatility.
                </p>
            </div>
            <div>
                <h4 class="text-stone-300 font-bold mb-4">Source</h4>
                <p class="text-xs">
                    Based on "Strategic Market Outlook 2026: The Capex Pivot and the Maturation of the Indian Bull Market".<br>
                    Data cut-off: February 2026.
                </p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- API Config ---
        const apiKey = ""; // Set your API Key here

        // --- Data & State ---
        const themeData = {
            electronics: {
                title: "Electronics Manufacturing (ISM 2.0)",
                icon: "üì±",
                pivot: "From 'Assembly' (PLI 1.0) to 'Value Creation/Components' (ISM 2.0).",
                thesis: "ISM 2.0 and ECMS (‚Çπ40,000 cr outlay) target components, PCBs, and semiconductor packaging (OSAT). Backward integration is critical to capture value.",
                beneficiaries: "EMS Companies (Dixon, Kaynes, Amber), Chemical Suppliers, Industrial Real Estate.",
                color: "teal"
            },
            biopharma: {
                title: "Biopharma Renaissance (SHAKTI)",
                icon: "üß¨",
                pivot: "From 'Generic Pharmacy' to 'Biologics Hub'.",
                thesis: "Biopharma SHAKTI scheme (‚Çπ10,000 cr) funds clinical trials and R&D. Biologics offer higher barriers to entry and higher margins than generics.",
                beneficiaries: "Research-driven majors (Biocon, Syngene), Vertically Integrated players (Sun Pharma).",
                color: "indigo"
            },
            infra: {
                title: "Capital Goods Supercycle",
                icon: "üèóÔ∏è",
                pivot: "From 'Consumption' to 'Investment-Led' Growth.",
                thesis: "Record ‚Çπ12.2 lakh crore capex creates 3-5 year order visibility. Focus on Tier-2/3 city development expands addressable market.",
                beneficiaries: "EPC (L&T), Building Materials (UltraTech), Industrial Automation (Siemens/ABB), Power (NTPC).",
                color: "amber"
            }
        };

        const portfolioModel = [
            { category: "Flexi Cap (Growth)", allocation: 0.30, name: "HDFC Flexi Cap", rationale: "Banking exposure for credit cycle." },
            { category: "Flexi Cap (Value)", allocation: 0.20, name: "Parag Parikh Flexi", rationale: "Downside protection/Hedge." },
            { category: "Large Cap", allocation: 0.20, name: "Nippon India Large", rationale: "Bedrock stability (GARP)." },
            { category: "Small Cap", allocation: 0.20, name: "Bandhan Small Cap", rationale: "Alpha from Mfg themes." },
            { category: "Balanced Adv.", allocation: 0.10, name: "ICICI Pru BAF", rationale: "Dynamic volatility management." }
        ];

        // --- Gemini Integration Functions ---
        
        async function callGemini(promptText) {
             const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const payload = {
                contents: [{ parts: [{ text: promptText }] }]
            };

            // Exponential backoff strategy
            const delays = [1000, 2000, 4000, 8000, 16000];
            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        if (response.status === 429) throw new Error('Too Many Requests');
                        throw new Error(`API Error: ${response.statusText}`);
                    }

                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "No response generated.";
                } catch (error) {
                    if (i === 4) return "Error generating response. Please try again later.";
                    await new Promise(resolve => setTimeout(resolve, delays[i]));
                }
            }
        }

        async function simulateRisk() {
            const input = document.getElementById('riskInput').value;
            const btn = document.getElementById('riskBtn');
            const resultDiv = document.getElementById('riskResult');

            if (!input) return;

            // UI Loading State
            btn.disabled = true;
            btn.innerHTML = 'Analyzing... <span class="animate-spin inline-block">‚è≥</span>';
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = '<span class="typing-cursor">Connecting to Gemini...</span>';

            const prompt = `You are a financial strategist for the Indian Market in 2026. 
            Context: India has high Capex, Fiscal deficit target 4.3%, GDP 7.4%.
            User Scenario: "${input}"
            Task: Analyze the specific impact of this scenario on the Indian Equity Market (Banking, Infra, IT sectors) and the Rupee.
            Constraint: Keep it strictly under 50 words. Be direct and professional.`;

            const response = await callGemini(prompt);

            resultDiv.innerHTML = `<strong>Analysis:</strong> ${response}`;
            btn.disabled = false;
            btn.innerHTML = 'Simulate ‚ú®';
        }

        async function generateMemo() {
            const amount = document.getElementById('sipAmount').value;
            const btn = document.getElementById('memoBtn');
            const resultDiv = document.getElementById('memoResult');

            // UI Loading State
            btn.disabled = true;
            btn.innerHTML = 'Drafting... <span class="animate-spin inline-block">‚úçÔ∏è</span>';
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = '<span class="typing-cursor">Analyzing portfolio structure...</span>';

            const prompt = `You are a savvy investment advisor in India (2026).
            User Data: Monthly SIP of ‚Çπ${amount}.
            Strategy: Core-Satellite (50% Core Stability, 30% Small Cap Alpha, 20% others).
            Task: Write a short, motivating 2-sentence "Investment Memo" to the client. Explain why this specific split allows them to capture the "Capex Pivot" growth while staying safe.
            Constraint: Keep it under 40 words. Tone: Professional yet encouraging.`;

            const response = await callGemini(prompt);

            resultDiv.innerHTML = `"${response}"`;
            btn.disabled = false;
            btn.innerHTML = '<span>‚ú®</span> Regenerate Investment Memo';
        }

        // --- Core Functions ---

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // Theme Switcher Logic
        function switchTheme(themeKey) {
            const data = themeData[themeKey];
            const contentDiv = document.getElementById('theme-content');
            
            // Update Tab Styles
            ['electronics', 'biopharma', 'infra'].forEach(k => {
                const btn = document.getElementById(`tab-${k}`);
                if (k === themeKey) {
                    btn.className = `active-tab px-6 py-3 font-semibold text-lg focus:outline-none transition w-full sm:w-auto`;
                } else {
                    btn.className = `inactive-tab px-6 py-3 font-semibold text-lg focus:outline-none transition w-full sm:w-auto hover:bg-stone-200`;
                }
            });

            // Update Content with Fade Effect
            contentDiv.style.opacity = 0;
            setTimeout(() => {
                contentDiv.innerHTML = `
                    <div class="flex flex-col lg:flex-row gap-8 items-center">
                        <div class="flex-1 space-y-4">
                            <div class="inline-block p-3 rounded-full bg-${data.color}-100 text-${data.color}-800 text-4xl mb-2">${data.icon}</div>
                            <h3 class="text-2xl font-bold text-stone-800">${data.title}</h3>
                            <div class="p-4 bg-${data.color}-50 border-l-4 border-${data.color}-500 rounded-r-lg">
                                <span class="font-bold text-${data.color}-900 block mb-1">STRATEGIC PIVOT</span>
                                <span class="text-${data.color}-800">${data.pivot}</span>
                            </div>
                            <p class="text-stone-600 leading-relaxed">${data.thesis}</p>
                        </div>
                        <div class="flex-1 bg-stone-50 p-6 rounded-xl border border-stone-200 w-full">
                            <h4 class="font-semibold text-stone-700 mb-3 border-b pb-2">Key Beneficiaries & Opportunity</h4>
                            <p class="text-stone-600 mb-4">${data.beneficiaries}</p>
                            <div class="flex items-center text-sm text-stone-500">
                                <span class="mr-2">üí°</span>
                                <em>Why now? Policy tailwinds + Global supply chain shifts.</em>
                            </div>
                        </div>
                    </div>
                `;
                contentDiv.style.opacity = 1;
            }, 200);
        }

        // Portfolio Calculator Logic
        let portfolioChartInstance = null;

        function calculatePortfolio() {
            const amountInput = document.getElementById('sipAmount');
            let amount = parseFloat(amountInput.value);
            if (isNaN(amount) || amount < 0) amount = 0;

            const tableBody = document.getElementById('allocationTableBody');
            tableBody.innerHTML = '';

            const chartData = [];
            const chartLabels = [];
            const chartColors = ['#14b8a6', '#0d9488', '#6366f1', '#f59e0b', '#f43f5e']; // teal-500, teal-600, indigo-500, amber-500, rose-500

            portfolioModel.forEach((item, index) => {
                const allocatedAmount = Math.round(amount * item.allocation);
                chartData.push(allocatedAmount);
                chartLabels.push(item.category);

                const row = `
                    <tr>
                        <td class="px-4 py-3 text-stone-300 font-medium">
                            <div class="flex items-center">
                                <div class="w-3 h-3 rounded-full mr-2" style="background-color: ${chartColors[index]}"></div>
                                ${item.category}
                                <span class="ml-2 text-xs text-stone-500 hidden sm:inline">(${item.name})</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-right text-stone-100 font-bold">‚Çπ${allocatedAmount.toLocaleString()}</td>
                        <td class="px-4 py-3 text-stone-400 text-xs hidden sm:table-cell">${item.rationale}</td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            });

            updatePortfolioChart(chartLabels, chartData, chartColors);
        }

        function updatePortfolioChart(labels, data, colors) {
            if (portfolioChartInstance) {
                portfolioChartInstance.data.datasets[0].data = data;
                portfolioChartInstance.update();
            } else {
                const ctx = document.getElementById('portfolioChart').getContext('2d');
                portfolioChartInstance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: data,
                            backgroundColor: colors,
                            borderWidth: 0,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false // Custom legend built in HTML
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return ' ‚Çπ' + context.raw.toLocaleString();
                                    }
                                }
                            }
                        },
                        cutout: '65%'
                    }
                });
            }
        }

        // --- Initialization & Charts ---

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Macro Chart
            const ctxMacro = document.getElementById('macroChart').getContext('2d');
            new Chart(ctxMacro, {
                type: 'bar',
                data: {
                    labels: ['FY15', 'FY26 (Est)', 'FY27 (Proj)'],
                    datasets: [
                        {
                            label: 'Govt Capex (Lakh Cr)',
                            data: [2.0, 11.1, 12.2],
                            backgroundColor: '#f59e0b', // Amber
                            yAxisID: 'y',
                            order: 2
                        },
                        {
                            label: 'Fiscal Deficit (%)',
                            data: [null, 4.9, 4.3], // Approximate past, current, target
                            borderColor: '#111827', // Stone 900
                            backgroundColor: '#111827',
                            type: 'line',
                            yAxisID: 'y1',
                            order: 1,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'Capex (Lakh Cr)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: { drawOnChartArea: false },
                            title: { display: true, text: 'Deficit (%)' },
                            min: 0,
                            max: 6
                        }
                    }
                }
            });

            // Initialize Valuation Chart
            const ctxVal = document.getElementById('valuationChart').getContext('2d');
            new Chart(ctxVal, {
                type: 'line',
                data: {
                    labels: ['2021 Peak', '2023', '2024', '2025', 'Feb 2026'],
                    datasets: [{
                        label: 'Nifty Smallcap 250 PE Ratio',
                        data: [48.2, 35.0, 29.0, 32.5, 26.2],
                        borderColor: '#0f766e', // Teal 700
                        backgroundColor: 'rgba(15, 118, 110, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: ['#0f766e', '#0f766e', '#0f766e', '#0f766e', '#f59e0b'], // Highlight last point
                        pointRadius: [4, 4, 4, 4, 8]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        annotation: {
                            annotations: {
                                label1: {
                                    type: 'label',
                                    xValue: 'Feb 2026',
                                    yValue: 28,
                                    backgroundColor: '#fff',
                                    content: ['Attractive Entry'],
                                    font: { size: 10 }
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            min: 20,
                            title: { display: true, text: 'Price to Earnings (PE)' }
                        }
                    }
                }
            });

            // Initialize Components
            switchTheme('electronics');
            calculatePortfolio();
            
            // Note: Replaced static Risk Toggle with AI Risk Simulator
        });
    </script>
</body>
</html><
